<?xml version="1.0"?>
<!--Based on Product specification - IRBT 4004/6004/7004-->
<!--http://isa.uniovi.es/~jalvarez/abb/en/3HEA802965-en.pdf-->
<robot xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:include filename="$(find abb_resources)/urdf/common_materials.xacro"/>

  <xacro:macro name="abb_irbt4004r" params="prefix">

    <!-- link list -->
    <link name="${prefix}track_right">
      <visual>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Track_End.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </visual>
      <collision>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Track_End.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </collision>
    </link>

    <link name="${prefix}track_mid_1">
      <visual>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </visual>
      <collision>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </collision>
    </link>

    <link name="${prefix}track_mid_2">
      <visual>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </visual>
      <collision>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </collision>
    </link>

    <link name="${prefix}track_mid_3">
      <visual>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </visual>
      <collision>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </collision>
    </link>

    <link name="${prefix}track_mid_4">
      <visual>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </visual>
      <collision>
        <origin xyz="-2.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Track_Mid.stl"/>
        </geometry>
        <xacro:material_abb_orange />
      </collision>
    </link>

    <!--Right carriage-->
    <link name="${prefix}carriage">
      <visual>
      <origin xyz="-0.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/visual/Carriage_right.stl"/>
        </geometry>
        <xacro:material_abb_dark_gray />
      </visual>
      <collision>
        <origin xyz="-0.5 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://abb_irbt4004_support/meshes/irbt4004/collision/Carriage_right.stl"/>
        </geometry>
        <xacro:material_abb_dark_gray />
      </collision>
    </link>

    <link name="${prefix}carriage_interface"/>
    <!-- end of link list -->

    <!-- joint list -->
    <joint name="${prefix}fixed_track_mid_1" type="fixed">
      <parent link="${prefix}track_right"/>
      <child link="${prefix}track_mid_1"/>
      <origin xyz="-1.000 0.000 0.000" rpy="0 0 0"/>
    </joint>

    <joint name="${prefix}fixed_track_mid_2" type="fixed">
      <parent link="${prefix}track_mid_1"/>
      <child link="${prefix}track_mid_2"/>
      <origin xyz="-1.000 0.000 0.000" rpy="0 0 0"/>
    </joint>

    <joint name="${prefix}fixed_track_mid_3" type="fixed">
      <parent link="${prefix}track_mid_2"/>
      <child link="${prefix}track_mid_3"/>
      <origin xyz="-1.000 0.000 0.000" rpy="0 0 0"/>
    </joint>

    <joint name="${prefix}fixed_track_mid_4" type="fixed">
      <parent link="${prefix}track_mid_3"/>
      <child link="${prefix}track_mid_4"/>
      <origin xyz="-1.000 0.000 0.000" rpy="0 0 0"/>
    </joint>

    <!--carriage-->
    <joint name="${prefix}joint_carriage" type="prismatic">
      <parent link="${prefix}track_right"/>
      <child link="${prefix}carriage"/>
      <origin xyz="-0.1 0 0" rpy="0 0 0"/>
      <axis xyz="-1 0 0"/>
      <limit effort="0" lower="0.000" upper="3.900" velocity="2.000"/> <!-- Product specification - IRBT 4004/6004/7004 -->
    </joint>

    <!-- Robot interface point -->
    <joint name="${prefix}carriage_interface_link" type="fixed">
      <parent link="${prefix}carriage"/>
      <child link="${prefix}carriage_interface"/>
      <origin xyz="-0.1045 0.560 0.3745" rpy="0 0 1.57079632" />
    </joint>
    <!-- end of joint list -->

  </xacro:macro>
</robot>
